# test-zadanie

## üìå –û–ø–∏—Å–∞–Ω–∏–µ

–≠—Ç–æ Ansible-–ø—Ä–æ–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ—Ç Linux-—Å–µ—Ä–≤–µ—Ä (Rocky Linux 9) –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è.  
–ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç:
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é LVM (baseline —Ç–µ–∫—É—â–µ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ + —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ `/home` –Ω–∞ 10G)
- –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ LVM-—Ä–∞–∑–¥–µ–ª–∞ `/opt` —Å –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –±–∏–Ω–∞—Ä–Ω–æ–≥–æ –¥–µ–º–æ–Ω–∞ `mydaemon` —Å systemd-—é–Ω–∏—Ç–æ–º
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ –¥–µ–º–æ–Ω–∞ –ø–æ CPU –∏ –ø–∞–º—è—Ç–∏ —á–µ—Ä–µ–∑ systemd
- –ù–∞—Å—Ç—Ä–æ–π–∫—É bonding (`bond0`) –∏–∑ –¥–≤—É—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ (`eth1` –∏ `eth2`) —Å –∑–∞–¥–∞–Ω–Ω—ã–º IP-–∞–¥—Ä–µ—Å–æ–º

---

## ‚úÖ –£—Å–ª–æ–≤–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è

- ‚úÖ **–û–°:** –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–æ—Å—å –Ω–∞ **Rocky Linux 9**
- ‚úÖ **NetworkManager:** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, bonding –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `nmcli`
- ‚úÖ **net.ifnames=0:** , —á—Ç–æ–±—ã –∏–º–µ–Ω–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ –±—ã–ª–∏ `eth0`, `eth1` –∏ `eth2`
- ‚úÖ **Ansible:** –í–µ—Ä—Å–∏—è **>= 2.14.x** (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç—É –∂–µ –∏–ª–∏ –≤—ã—à–µ)
- ‚úÖ **Ansible Collections:**
  - `community.general >= 7.0.0` ‚Äî –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å LVM
  - `ansible.posix >= 1.4.0` ‚Äî –¥–ª—è –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

---

## ‚úÖ –ö–∞–∫ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Ansible:
   ```bash
   python3 -m pip install ansible

2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
   ```bash
   ansible-galaxy collection install -r requirements.yml
## ‚úÖ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

1. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ inventory/hosts.ini, —É–∫–∞–∑–∞–≤ –≤–∞—à —Ü–µ–ª–µ–≤–æ–π —Å–µ—Ä–≤–µ—Ä.
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏–∑–º–µ–Ω–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ vars/main.yml

3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–ª–µ–π–±—É–∫
   ```bash
   ansible-playbook -i inventory/hosts.ini playbook.yml
## ‚úÖ –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Ä–æ–ª—å `myrole`

- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ —Ü–µ–ª–µ–≤–æ–π —Ö–æ—Å—Ç ‚Äî **Rocky Linux 9**
- –ü–æ–ª—É—á–∞–µ—Ç —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞–∑–º–µ—Ä LVM –¥–ª—è —Ä–∞–∑–¥–µ–ª–∞ `/home` (–∏–ª–∏ –ª—é–±–æ–≥–æ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ)
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç baseline LV —Ä–∞–∑–º–µ—Ä –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
- –†–∞—Å—à–∏—Ä—è–µ—Ç LV `/home` –Ω–∞ **+10G –æ—Ç baseline**, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ (—Ç–∞—Å–∫–∞ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–∞)
- –°–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–π LV –¥–ª—è `/opt` (–∏–ª–∏ –¥—Ä—É–≥–æ–π –ø—É—Ç—å), —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –µ–≥–æ –≤ **XFS**, –º–æ–Ω—Ç–∏—Ä—É–µ—Ç –∏ –ø—Ä–æ–ø–∏—Å—ã–≤–∞–µ—Ç –≤ `fstab`
- –°–æ–∑–¥–∞—ë—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `myuser` —Å –¥–æ–º–∞—à–Ω–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–µ–π `/opt/daemon`
- –ö–æ–ø–∏—Ä—É–µ—Ç –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª **`mydaemon`** –∏ —à–∞–±–ª–æ–Ω –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –í—ã—á–∏—Å–ª—è–µ—Ç –ª–∏–º–∏—Ç—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è **CPU** –∏ **–ø–∞–º—è—Ç–∏** –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö `memory_limit_percent` –∏ `cpu_limit_percent`
- –°–æ–∑–¥–∞—ë—Ç **systemd unit-—Ñ–∞–π–ª** —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏ `MemoryLimit` –∏ `CPUQuota`
- –í–∫–ª—é—á–∞–µ—Ç –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç `mydaemon` –∫–∞–∫ —Å–∏—Å—Ç–µ–º–Ω—ã–π —Å–µ—Ä–≤–∏—Å
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç **bonding** –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ (`eth1` –∏ `eth2`) –≤ `bond0` —Å IP-–∞–¥—Ä–µ—Å–æ–º, —É–∫–∞–∑–∞–Ω–Ω—ã–º –≤ `vars`

‚úÖ –ü—Ä–∏–º–µ—á–∞–Ω–∏—è
- –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (VG, –∏–º–µ–Ω–∞ LV, —Ç–æ—á–∫–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, —Ä–∞–∑–º–µ—Ä, IP bonding) –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ ‚Äî –ª–µ–≥–∫–æ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞ –¥—Ä—É–≥–∏—Ö —Ö–æ—Å—Ç–∞—Ö.
- Baseline-—Ñ–∞–π–ª —Ä–∞–∑–º–µ—Ä–∞ LV —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –Ω–∞ —Ü–µ–ª–µ–≤–æ–º —Ö–æ—Å—Ç–µ –≤ /etc/myrole_<lv_name>_initial_size.yml –∏ –Ω–µ –∑–∞—Ç–∏—Ä–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—É—Å–∫–∞—Ö.
- –ü–ª–µ–π–±—É–∫ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–µ–Ω: –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—É—Å–∫ –Ω–µ –ø—Ä–∏–≤–µ–¥—ë—Ç –∫ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–º—É —É–≤–µ–ª–∏—á–µ–Ω–∏—é LVM –∏–ª–∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏—é bonding.
- –î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ bonding —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã eth1 –∏ eth2 –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥—Ä—É–≥–∏–º–∏ –ø—Ä–æ—Ñ–∏–ª—è–º–∏.

## ‚úÖ –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
üóÇÔ∏è LVM
–ß—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –Ω–æ–≤—ã–µ —Ä–∞–∑–º–µ—Ä—ã –∏ —Ç–æ—á–∫–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
```bash
lsblk -f
```

üåê Network
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å bonding: —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ IP
```bash
ip a
```

# ‚öôÔ∏è Systemd Unit 
–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞ mydaemon
```bash
systemctl status mydaemon.service
```
# –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –¥–µ–º–æ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –æ–∂–∏–¥–∞–µ—Ç—Å—è
–ö–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –ª–æ–≥
```bash
tail -f /var/log/messages
```
# –û–∂–∏–¥–∞–µ–º–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:
%TIMESTAMP% - Veni, Vidi, Vici


